<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

  <head>
    <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>Allocator overview | Inventory System </title>
      <meta name="viewport" content="width=device-width">
      <meta name="title" content="Allocator overview | Inventory System ">
    
    
      <link rel="shortcut icon" href="../../../../favicon.ico">
      <link rel="stylesheet" href="../../../../styles/docfx.vendor.min.css">
      <link rel="stylesheet" href="../../../../styles/docfx.css">
      <link rel="stylesheet" href="../../../../styles/main.css">
      <meta property="docfx:navrel" content="../../../../toc.html">
      <meta property="docfx:tocrel" content="../../../../toc.html">
    
    <meta property="docfx:rel" content="../../../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../../../../index.html">
                <img id="logo" class="svg" src="../../../../logo.svg" alt="Inventory System">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>

        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">

        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first=First data-prev=Previous data-next=Next data-last=Last></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        <div class="article row grid">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="allocator-overview">Allocator overview</h1>

<p>An <strong>allocator</strong> governs unmanaged memory from which you can make allocations. Different allocators organize and track their memory in different ways. The Collections package includes the following allocators:</p>
<ul>
<li><a href="#allocatortemp"><code>Allocator.Temp</code></a>: The fastest allocator, for short-lived allocations. You can't pass this allocator to a job.</li>
<li><a href="#allocatortempjob"><code>Allocator.TempJob</code></a>: A short-lived allocator that you can pass into jobs.</li>
<li><a href="#allocatorpersistent"><code>Allocator.Persistent</code></a>: The slowest allocator for indefinite lifetime allocations. You can pass this allocator to a job.</li>
</ul>
<h2 id="allocatortemp">Allocator.Temp</h2>
<p>Each frame, the main thread creates a Temp allocator which it deallocates in its entirety at the end of the frame. Each job also creates one Temp allocator per thread, and deallocates them in their entirety at the end of the job. Because a Temp allocator gets discarded as a whole, you don't need to manually deallocate Temp allocations, and doing so does nothing. The minimum alignment of Temp allocations is 64 bytes.</p>
<p>Temp allocations are only safe to use in the thread and the scope where they were allocated. While you can make Temp allocations within a job, you can't pass main thread Temp allocations into a job. For example, you can't pass a native array that's Temp allocated in the main thread into a job.</p>
<h2 id="allocatortempjob">Allocator.TempJob</h2>
<p>You must deallocate TempJob allocations within 4 frames of their creation. 4 frames is the limit so that you can have an allocation that lasts a couple of frames with some extra margin for error. The minimum alignment of TempJob allocations is 16 bytes.</p>
<p>For <code>Native-</code> collection types, the disposal safety checks throw an exception if a TempJob allocation lasts longer than 4 frames. For <code>Unsafe-</code> collection types, you must deallocate them within 4 frames, but Unity doesn't perform any safety checks to make sure that you do so.</p>
<h2 id="allocatorpersistent">Allocator.Persistent</h2>
<p>Because Persistent allocations can remain indefinitely, safety checks can't detect if a Persistent allocation has outlived its intended lifetime. As such, you must deallocate a Persistent allocation when you no longer need it. The minimum alignment of Persistent allocations is 16 bytes.</p>
<h2 id="deallocating-an-allocator">Deallocating an allocator</h2>
<p>Each collection retains a reference to the allocator that allocated its memory. This is because you must specify the allocator to deallocate its memory.</p>
<ul>
<li>An <code>Unsafe-</code> collection's <code>Dispose</code> method deallocates its memory.</li>
<li>A <code>Native-</code> collection's <code>Dispose</code> method deallocates its memory and frees the handles needed for safety checks.</li>
<li>An enumerator's <code>Dispose</code> method does nothing. The method exists only to fulfill the <code>IEnumerator&lt;T&gt;</code> interface.</li>
</ul>
<p>To dispose a collection after the jobs which need it have run, you can use the <code>Dispose(JobHandle)</code> method. This creates and schedules a job which disposes of the collection, and this new job takes the input handle as its dependency. Effectively, the method defers disposal until after the dependency runs:</p>
<pre><code class="lang-cs" name="allocation_dispose_job">NativeArray&lt;int&gt; nums = new NativeArray&lt;int&gt;(10, Allocator.TempJob);

// Create and schedule a job that uses the array.
ExampleJob job = new ExampleJob { Nums = nums };
JobHandle handle = job.Schedule();

// Create and schedule a job that will dispose the array after the ExampleJob has run.
// Returns the handle of the new job.
handle = nums.Dispose(handle);
</code></pre><h3 id="iscreated-property">IsCreated property</h3>
<p>The <code>IsCreated</code> property of a collection is false only in the following cases:</p>
<ul>
<li>Immediately after creating a collection with its default constructor.</li>
<li>After <code>Dispose</code> has been called on the collection.</li>
</ul>
<div class="NOTE">
<h5>Note</h5>
<p>You don't need to use a collection's default constructor. The constructor is only available because C# requires all structs have a public default constructor.</p>
</div>
<p>Calling <code>Dispose</code> on a collection sets <code>IsCreated</code> to false only for that struct, and not in any copies of the struct. <code>IsCreated</code> might still be true even after the collection's underlying memory is deallocated in the following situations:</p>
<ul>
<li><code>Dispose</code> was called on a different copy of the struct.</li>
<li>The underlying memory was deallocated via an <a href="allocator-aliasing.html">alias</a>.</li>
</ul>
<h2 id="additional-resources">Additional resources</h2>
<ul>
<li><a href="allocator-aliasing.html">Aliasing allocators</a></li>
<li><a href="allocator-rewindable.html">Rewindable allocators</a></li>
<li><a href="allocator-custom-define.html">Define a custom allocator</a></li>
</ul>

</article>
          </div>

          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In this article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      
      <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="../../../../styles/docfx.vendor.min.js"></script>
    <script type="text/javascript" src="../../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../../styles/main.js"></script>
  </body>
</html>
